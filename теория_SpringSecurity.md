## 75.Введение  в Spring Security
## Spring Security
- Spring Security - компонент Spring Framework
- Является стандартом для обеспечения безопасности в Spring приложениях
- Помогает реализовать функционал аутентификации и авторизации 
- Может использоваться как в монолитных, так и в микросервисных приложениях

**Аутентификация**- доказали сервису, что это мы (введением логина и пароля, например)
Прошли аутентификацию->попадаем на **авторизацию**
**Авторизация** - в зависимости от роли выдаются полномочия (пользователь, админ,директор и т.д.)\
Одни роли авторизованы на одно, другие-на другое.

Spring Security встраивается в приложение с помощб. фильтров\
HTTP запрос->фильтры security->Spring приложение
**фильтр**- объект,который перехватывает все входящие HTTP запросы

### Как устрена аутентификация в Spring Security ?

Когда мы хотим реализовать аутентификацию в Spring Security,мы должны создать класс, который реализует интерфейс AuthentificationProvider. В этом интефейсе есть один метод **authentificate()**, в нем описывается логика аутентификации пользователя.На вход в метод подается объект **Authentification**, и возвращает метод тоже объект Authentification.
Authentifications(Credentials ("Логин,пароль")) подается на вход в метод  **authentificate()**,внутри этого метода проводится аутентификация (можно сопоставить логин и пароль в Б\Д тому,что предали в качестве аргумента.)Или обратиться к специальному серверу, который проводит аутентификацию, на него посылаем **Credentials**,сервер сам проверяет логин и пароль и в ответ, например, посылает сообщение о том, прошла аутентификация или нет.\
Когда аутентификация прошла или не прошла, из метода autentificate() возвращается объект Autentification, но внутри этого объекта помиммо логина и пароля может лежать объект **Principal**, объект, который получается на выходе после успешной аутентификации. Чаще всего, это сам объект идентификации.\
И теперь, каждый раз, когда пользователь будет делать запрос к нашему приложению, мы будем иметь доступ к его объекту Autentification(с Principal внутри).\
Как это возможно? Ведь HTTP-stateless/
ОБъект помещается в сессию пользователя.За то, чтобы при каждом запросе этот объект подгружался из сессии, отвечает отдельный фильтр Spring Security.\
Пока сессия пользователя действительна - можем получать объект Autentification и не заставлять пользователя проходить аутентификацию еще раз.

## 75.Введение  в Spring Security
**Cессия** - объект на сервере, хранящий информацию о клиенте\
**Cookies** - информация на браузере клиента, которую он посылает каждый раз при обращении к серверу.
- Пара строк ключ-значение, которая хранится в браузере для конкретного сайта
- Присылается браузером при каждом запросе к серверу
- Позволяет хранить некоторые данные в памяти у клиента.Позволяет идентифицировать пользователя. 

 Нужны чтобы открывать нужному клиенту нужную сессию.\
**Cookie** состоит из:\
-Название, значение
-Срок действия(поле expires) - когда удаляется из браузера
- Domain,Path - к какому домену (сайту) относится. При запросе к какому адресу должна отсылаться (Same Origin Policy).  
 
Принцип арботы сессии:\
-Клиент получает от сервера cookie  с названием "JSESSIONID".Значение этого cookie - уникальный идентификатор пользователя.
- По этому cookie сервер узнает пользвателя и узнает его сессию.
-Если очистить cookies в браузере, сервер больше не сможет узнать пользователя и его сессию.

## 79. Aутентификация в Spring Security
Для настройки Spring Security нужно: 

1) реализовать методы  интерфейса **UserDetails**\ в отдельном классе в зависимости от сущности в папке **security**

- **public Collection<? extends GrantedAuthority> getAuthorities()**
- **public String getPassword()**
- **public String getUserName()**
- **public boolean isAccountNonExpired()**
- **public boolean isAccountNonLocked()**
- **public boolean isCredentialsNonExpired()** 
- **public boolean isEnabled()**

2) настроить кофигурацию Spring Security в папке **config** (класс SecurityCongig )\
2.1 **@EnableWebSecurity** - аннотация указывает на то, что это конфигурация для Spring Security\
2.2 Следовать уроку алишева Аутентификация в Spring Security : ))

Общая схема:\
**SecurityConfig**->**AuthProviderImpl(implementation of AuthProvider)**->\
->**PersonDetailsService(implementation of UserDetailsService)**->**PersonDetails(impl-on of UserDetails)**->**Person**->**DataBase**

Как правило, в общем случае простого сравнения пароля и username  из браузера с паролем и username из бд,
не используется AuthProviderImpl (своя реализация AuthProvider),такая схема нужна только для кастомной аутентификации (отправка аутентификации на уентральный удаленный сервер) и схема упрощается:

## 80. Aутентификация в Spring Security (часть2)

**SecurityConfig**->**PersonDetailsService(implementation of UserDetailsService)**->**PersonDetails(impl-on of UserDetails)**->**Person**->**DataBase**
Передаем SecurityConfig только человека из б/д и он сравнит сам пароли и имя с пришедшим из браузера.(проект 
SecurityApp2)












